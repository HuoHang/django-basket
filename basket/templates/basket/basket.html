{% extends "basket/base.html" %}
{% load i18n %}

{% block title %}{% trans 'Basket' %}{% endblock title %}

{% block content %}
<script type="text/javascript">
<!--
$(document).ready(function() {
	$('#basket-refresh').click(function() {
		$(this).after('<input type="hidden" name="refresh" value="1" />');
	});
});
//-->
</script>
{% if formset.forms %}
    <form action="." method="post">
	    <table class="checkout">
	        <tr>
	            <th>&nbsp;</th>
	            <th>{% trans 'Item name' %}</th>
	            <th>{% trans 'Price' %}</th>
	            <th>{% trans 'Quantity' %}</th>
	            <th>{% trans 'Total' %}</th>
	        </tr>
	        {% for form in formset.forms %}
			<tr>
	            <td>{{ form.keep }}{{ form.content_type }}{{ form.object_id }}{{ form.id }}</td>
	            <td><a target="_blank" href="{{ form.instance.content_object.get_absolute_url }}" title="{% trans 'Go to item page' %}">{{ form.instance.content_object }}</a></td>
				<td>{{ form.instance.get_price }}</td>
				<td>{{ form.quantity }}{{ form.quantity.errors }}</td>
				<td>{{ form.instance.get_sum }}</td>
			</tr>
	        {% endfor %}
	        <tr>
	            <th colspan="3">{% trans 'Total' %}</th>
	            <th>{{ order.goods }}</th>
	            <th>{{ order.summary }}</th>
	        </tr>
	    </table>
        <p>
		    {{ formset.management_form }}
		    {% csrf_token %}
            <input type="submit" value="{% trans 'Go to checkout' %}" />
            <input type="submit" id="basket-refresh" value="{% trans 'Update items' %}" />
        </p>
	</form>
    {# if you want, you can show order info form here #}
    
    <form action="{% url order_confirm %}" method="POST">
        {{ order_form.as_p }}
        {% csrf_token %}
        <input type="submit" value="{% trans 'Submit order' %}" />
    </form>
{% else %}
	<p>{% trans 'Your basket is empty' %}</p>
{% endif %}


{% endblock content %}
